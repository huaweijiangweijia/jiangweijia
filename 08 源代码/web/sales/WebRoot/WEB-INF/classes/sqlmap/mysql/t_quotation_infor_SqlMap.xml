<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="t_quotation_infor">
  <resultMap class="com.tl.resource.dao.pojo.TQuotationInfor" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    <result column="id" jdbcType="VARCHAR" property="id" />
    <result column="contract_infor_id" jdbcType="VARCHAR" property="contractInforId" />
    <result column="quotation_code" jdbcType="VARCHAR" property="quotationCode" />
    <result column="customer_code" jdbcType="VARCHAR" property="customerCode" />
    <result column="customer_name" jdbcType="VARCHAR" property="customerName" />
    <result column="quotation_date" jdbcType="VARCHAR" property="quotationDate" />
    <result column="seller_name" jdbcType="VARCHAR" property="sellerName" />
    <result column="currency_" jdbcType="VARCHAR" property="currency" />
    <result column="currency_name" jdbcType="VARCHAR" property="currencyName" />
    <result column="payment_condition" jdbcType="VARCHAR" property="paymentCondition" />
    <result column="tax_rate" jdbcType="DECIMAL" property="taxRate" />
    <result column="quotation_type" jdbcType="INTEGER" property="quotationType" />
    <result column="cus_contact_person" jdbcType="VARCHAR" property="cusContactPerson" />
    <result column="status" jdbcType="INTEGER" property="status" />
    <result column="delivery_type" jdbcType="VARCHAR" property="deliveryType" />
    <result column="tax_money" jdbcType="DECIMAL" property="taxMoney" />
    <result column="product_money" jdbcType="DECIMAL" property="productMoney" />
    <result column="total_money" jdbcType="DECIMAL" property="totalMoney" />
    <result column="edit_time" jdbcType="TIMESTAMP" property="editTime" />
    <result column="editor_id" jdbcType="VARCHAR" property="editorId" />
    <result column="editor_name" jdbcType="VARCHAR" property="editorName" />
    <result column="edit_date" jdbcType="TIMESTAMP" property="editDate" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
    <result column="memo" jdbcType="VARCHAR" property="memo" />
    <result column="overall_rebate" jdbcType="DECIMAL" property="overallRebate" />
    <result column="final_money" jdbcType="DECIMAL" property="finalMoney" />
    <result column="customer_phone" jdbcType="VARCHAR" property="customerPhone" />
    <result column="customer_fax" jdbcType="VARCHAR" property="customerFax" />
    <result column="urgent_level" jdbcType="INTEGER" property="urgentLevel" />
    <result column="valid_start_date" jdbcType="VARCHAR" property="validStartDate" />
    <result column="valid_end_date" jdbcType="VARCHAR" property="validEndDate" />
    
    <result column="will_order_expected" jdbcType="INTEGER" property="willOrderExpected" />
    <result column="will_formal_date" jdbcType="VARCHAR" property="willFormalDate" />
    
    <result column="imp_to_quo_code" jdbcType="VARCHAR" property="impToQuoCode" />
    
    <result column="seller_id" jdbcType="VARCHAR" property="sellerId" />
  </resultMap>
  
  <resultMap class="com.tl.resource.dao.pojo.TQuotationInfor" id="QuotationInfor_groupby">
    <result column="customer_code" jdbcType="VARCHAR" property="customerCode" />
    <result column="customer_name" jdbcType="VARCHAR" property="customerName" />
    <result column="seller_name" jdbcType="VARCHAR" property="sellerName" />
   <result column="seller_id" jdbcType="VARCHAR" property="sellerId" />
    <result column="currency_name" jdbcType="VARCHAR" property="currencyName" />
    <result column="tax_rate" jdbcType="DECIMAL" property="taxRate" />
    <result column="tax_money" jdbcType="DECIMAL" property="taxMoney" />
    <result column="product_money" jdbcType="DECIMAL" property="productMoney" />
    <result column="total_money" jdbcType="DECIMAL" property="totalMoney" />
    <result column="payment_condition" jdbcType="VARCHAR" property="paymentCondition" />
    <result column="user_name" jdbcType="VARCHAR" property="userName" />
  </resultMap>
 
   <resultMap id="mapForOrderSeleQuo" class="com.tl.resource.dao.pojo.TQuotationInfor" extends="ibatorgenerated_BaseResultMap">
    <result column="cus_lock_status" jdbcType="Integer" property="cusLockStatus" />
  </resultMap>
  
  <sql id="ibatorgenerated_Example_Where_Clause">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    <iterate conjunction="or" prepend="where" property="oredCriteria" removeFirstPrepend="iterate">
      <isEqual compareValue="true" property="oredCriteria[].valid">
        (
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithoutValue">
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithSingleValue">
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithListValue">
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate close=")" conjunction="," open="(" property="oredCriteria[].criteriaWithListValue[].values">
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithBetweenValue">
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" parameterClass="com.tl.resource.dao.pojo.TQuotationInforExample" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    select id, contract_infor_id, quotation_code, customer_code, customer_name, quotation_date,
      seller_name, currency_, currency_name, payment_condition, tax_rate, quotation_type,
      cus_contact_person, status, delivery_type, tax_money, product_money, total_money, edit_time,
      editor_id, editor_name, edit_date, user_name, memo, overall_rebate, final_money ,customer_phone,customer_fax,
      urgent_level,valid_start_date,valid_end_date,
      will_order_expected,will_formal_date,imp_to_quo_code, seller_id
    from t_quotation_infor
    <isParameterPresent>
      <include refid="t_quotation_infor.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause">
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="getTheQuotationinforGroupBy" parameterClass="java.util.List" resultMap="QuotationInfor_groupby">
    select customer_code, customer_name, user_name,
      seller_name,seller_id, currency_name,  tax_rate,payment_condition, 
      sum(tax_money) tax_money, sum(product_money) product_money, sum(total_money) total_money
    from t_quotation_infor i    
    where i.id in 
    <iterate conjunction="," open="(" close=")" >
       #value[]#
    </iterate>
    group by customer_code, customer_name, user_name, seller_name,seller_id, currency_name,  tax_rate,payment_condition
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    select id, contract_infor_id, quotation_code, customer_code, customer_name, quotation_date,
      seller_name, currency_, currency_name, payment_condition, tax_rate, quotation_type,
      cus_contact_person, status, delivery_type, tax_money, product_money, total_money, edit_time,
      editor_id, editor_name, edit_date, user_name, memo, overall_rebate, final_money,customer_fax,customer_phone,
      urgent_level,valid_start_date,valid_end_date,
      will_order_expected,will_formal_date,imp_to_quo_code, seller_id
    from t_quotation_infor
    where id = #id:VARCHAR#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    delete from t_quotation_infor
    where id = #id:VARCHAR#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.tl.resource.dao.pojo.TQuotationInforExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    delete from t_quotation_infor
    <include refid="t_quotation_infor.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    insert into t_quotation_infor (id, contract_infor_id, quotation_code, customer_code,
      customer_name, quotation_date, seller_name, currency_, currency_name, payment_condition,
      tax_rate, quotation_type, cus_contact_person, status, delivery_type, tax_money, product_money,
      total_money, edit_time, editor_id, editor_name, edit_date, user_name, memo,
      overall_rebate, final_money,customer_phone,customer_fax,urgent_level,valid_start_date,valid_end_date,
      will_order_expected,will_formal_date,imp_to_quo_code, seller_id)
    values (#id:VARCHAR#, #contractInforId:VARCHAR#, #quotationCode:VARCHAR#,
      #customerCode:VARCHAR#, #customerName:VARCHAR#, #quotationDate:VARCHAR#, #sellerName:VARCHAR#,
      #currency:VARCHAR#, #currencyName:VARCHAR#, #paymentCondition:VARCHAR#, #taxRate:DECIMAL#,
      #quotationType:INTEGER#, #cusContactPerson:VARCHAR#, #status:INTEGER#, #deliveryType:VARCHAR#,
      #taxMoney:DECIMAL#, #productMoney:DECIMAL#, #totalMoney:DECIMAL#, #editTime:TIMESTAMP#,
      #editorId:VARCHAR#, #editorName:VARCHAR#, #editDate:TIMESTAMP#,
      #userName:VARCHAR#, #memo:VARCHAR#, #overallRebate:DECIMAL#, #finalMoney:DECIMAL#,#customerPhone:VARCHAR#, 
      #customerFax:VARCHAR#,#urgentLevel:INTEGER#,#validStartDate:VARCHAR#,#validEndDate:VARCHAR#,
      #willOrderExpected:INTEGER#,#willFormalDate:VARCHAR#,#impToQuoCode:VARCHAR#,#sellerId:VARCHAR#)
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    insert into t_quotation_infor
    <dynamic prepend="(">
      <isNotNull prepend="," property="id">
        id
      </isNotNull>
      <isNotNull prepend="," property="contractInforId">
        contract_infor_id
      </isNotNull>
      <isNotNull prepend="," property="quotationCode">
        quotation_code
      </isNotNull>
      <isNotNull prepend="," property="customerCode">
        customer_code
      </isNotNull>
      <isNotNull prepend="," property="customerName">
        customer_name
      </isNotNull>
      <isNotNull prepend="," property="quotationDate">
        quotation_date
      </isNotNull>
      <isNotNull prepend="," property="sellerName">
        seller_name
      </isNotNull>
      <isNotNull prepend="," property="currency">
        currency_
      </isNotNull>
      <isNotNull prepend="," property="currencyName">
        currency_name
      </isNotNull>
      <isNotNull prepend="," property="paymentCondition">
        payment_condition
      </isNotNull>
      <isNotNull prepend="," property="taxRate">
        tax_rate
      </isNotNull>
      <isNotNull prepend="," property="quotationType">
        quotation_type
      </isNotNull>
      <isNotNull prepend="," property="cusContactPerson">
        cus_contact_person
      </isNotNull>
      <isNotNull prepend="," property="status">
        status
      </isNotNull>
      <isNotNull prepend="," property="deliveryType">
        delivery_type
      </isNotNull>
      <isNotNull prepend="," property="taxMoney">
        tax_money
      </isNotNull>
      <isNotNull prepend="," property="productMoney">
        product_money
      </isNotNull>
      <isNotNull prepend="," property="totalMoney">
        total_money
      </isNotNull>
      <isNotNull prepend="," property="editTime">
        edit_time
      </isNotNull>
      <isNotNull prepend="," property="editorId">
        editor_id
      </isNotNull>
      <isNotNull prepend="," property="editorName">
        editor_name
      </isNotNull>
      <isNotNull prepend="," property="editDate">
        edit_date
      </isNotNull>
      <isNotNull prepend="," property="userName">
        user_name
      </isNotNull>
      <isNotNull prepend="," property="memo">
        memo
      </isNotNull>
      <isNotNull prepend="," property="overallRebate">
        overall_rebate
      </isNotNull>
      <isNotNull prepend="," property="finalMoney">
        final_money
      </isNotNull>
      <isNotNull prepend="," property="customerPhone">
        customer_phone
      </isNotNull>
      <isNotNull prepend="," property="customerFax">
        customer_fax
      </isNotNull> 
      <isNotNull prepend="," property="urgentLevel">
        urgent_level
      </isNotNull>
      <isNotNull prepend="," property="validStartDate">
        valid_start_date
      </isNotNull>
      <isNotNull prepend="," property="validEndDate">
        valid_end_date
      </isNotNull>
      
      <isNotNull prepend="," property="willOrderExpected">
        will_order_expected
      </isNotNull>
      <isNotNull prepend="," property="willFormalDate">
        will_formal_date
      </isNotNull>
      
      <isNotNull prepend="," property="impToQuoCode">
        imp_to_quo_code
      </isNotNull>
      
      <isNotNull prepend="," property="sellerId">
        seller_id
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="id">
        #id:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="contractInforId">
        #contractInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="quotationCode">
        #quotationCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerCode">
        #customerCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerName">
        #customerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="quotationDate">
        #quotationDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sellerName">
        #sellerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="currency">
        #currency:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="currencyName">
        #currencyName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="paymentCondition">
        #paymentCondition:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="taxRate">
        #taxRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="quotationType">
        #quotationType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="cusContactPerson">
        #cusContactPerson:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="deliveryType">
        #deliveryType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="taxMoney">
        #taxMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productMoney">
        #productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="totalMoney">
        #totalMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="editTime">
        #editTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="editorId">
        #editorId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editorName">
        #editorName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editDate">
        #editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="userName">
        #userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo">
        #memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="overallRebate">
        #overallRebate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="finalMoney">
        #finalMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="customerPhone">
        #customerPhone:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerFax">
        #customerFax:VARCHAR#
      </isNotNull>  
      <isNotNull prepend="," property="urgentLevel">
        #urgentLevel:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="validStartDate">
        #validStartDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="validEndDate">
        #validEndDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="willOrderExpected">
        #willOrderExpected:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="willFormalDate">
        #willFormalDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="impToQuoCode">
        #impToQuoCode:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="sellerId">
        #sellerId:VARCHAR#
      </isNotNull>
      )
    </dynamic>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.tl.resource.dao.pojo.TQuotationInforExample" resultClass="java.lang.Integer">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    select count(*) from t_quotation_infor
    <include refid="t_quotation_infor.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    update t_quotation_infor
    <dynamic prepend="set">
      <isNotNull prepend="," property="record.id">
        id = #record.id:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.contractInforId">
        contract_infor_id = #record.contractInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.quotationCode">
        quotation_code = #record.quotationCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.customerCode">
        customer_code = #record.customerCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.customerName">
        customer_name = #record.customerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.quotationDate">
        quotation_date = #record.quotationDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.sellerName">
        seller_name = #record.sellerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.currency">
        currency_ = #record.currency:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.currencyName">
        currency_name = #record.currencyName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.paymentCondition">
        payment_condition = #record.paymentCondition:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.taxRate">
        tax_rate = #record.taxRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.quotationType">
        quotation_type = #record.quotationType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.cusContactPerson">
        cus_contact_person = #record.cusContactPerson:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.status">
        status = #record.status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.deliveryType">
        delivery_type = #record.deliveryType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.taxMoney">
        tax_money = #record.taxMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.productMoney">
        product_money = #record.productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.totalMoney">
        total_money = #record.totalMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.editTime">
        edit_time = #record.editTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.editorId">
        editor_id = #record.editorId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.editorName">
        editor_name = #record.editorName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.editDate">
        edit_date = #record.editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.userName">
        user_name = #record.userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.memo">
        memo = #record.memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.overallRebate">
        overall_rebate = #record.overallRebate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.finalMoney">
        final_money = #record.finalMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="record.customerPhone">
        customer_phone = #record.customerPhone:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.customerFax">
        customer_fax = #record.customerFax:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.urgentLevel">
        urgent_level = #record.urgentLevel:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.validStartDate">
        valid_start_date = #record.validStartDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.validEndDate">
        valid_end_date = #record.validEndDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="record.willOrderExpected">
        will_order_expected = #record.willOrderExpected:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="record.willFormalDate">
        will_formal_date = #record.willFormalDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="record.impToQuoCode">
        imp_to_quo_code = #record.impToQuoCode:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="record.sellerId">
        seller_id = #record.sellerId:VARCHAR#
      </isNotNull>
    </dynamic>
    <isParameterPresent>
      <include refid="t_quotation_infor.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    update t_quotation_infor
    set id = #record.id:VARCHAR#,
      contract_infor_id = #record.contractInforId:VARCHAR#,
      quotation_code = #record.quotationCode:VARCHAR#,
      customer_code = #record.customerCode:VARCHAR#,
      customer_name = #record.customerName:VARCHAR#,
      quotation_date = #record.quotationDate:VARCHAR#,
      seller_name = #record.sellerName:VARCHAR#,
      currency_ = #record.currency:VARCHAR#,
      currency_name = #record.currencyName:VARCHAR#,
      payment_condition = #record.paymentCondition:VARCHAR#,
      tax_rate = #record.taxRate:DECIMAL#,
      quotation_type = #record.quotationType:INTEGER#,
      cus_contact_person = #record.cusContactPerson:VARCHAR#,
      status = #record.status:INTEGER#,
      delivery_type = #record.deliveryType:VARCHAR#,
      tax_money = #record.taxMoney:DECIMAL#,
      product_money = #record.productMoney:DECIMAL#,
      total_money = #record.totalMoney:DECIMAL#,
      edit_time = #record.editTime:TIMESTAMP#,
      editor_id = #record.editorId:VARCHAR#,
      editor_name = #record.editorName:VARCHAR#,
      edit_date = #record.editDate:TIMESTAMP#,
      user_name = #record.userName:VARCHAR#,
      memo = #record.memo:VARCHAR#,
      overall_rebate = #record.overallRebate:DECIMAL#,
      final_money = #record.finalMoney:DECIMAL#,
      customer_phone = #record.customerPhone:VARCHAR#,
      customer_fax = #record.customerFax:VARCHAR#,
      urgent_level = #record.urgentLevel:INTEGER#,
      valid_start_date = #record.validStartDate:VARCHAR#,
      valid_end_date = #record.validEndDate:VARCHAR#,
      
      will_order_expected = #record.willOrderExpected:INTEGER#,
      will_formal_date = #record.willFormalDate:VARCHAR#,
      
      imp_to_quo_code = #record.impToQuoCode:VARCHAR#,
      
      seller_id = #record.sellerId:VARCHAR#
    <isParameterPresent>
      <include refid="t_quotation_infor.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    update t_quotation_infor
    <dynamic prepend="set">
      <isNotNull prepend="," property="contractInforId">
        contract_infor_id = #contractInforId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="quotationCode">
        quotation_code = #quotationCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerCode">
        customer_code = #customerCode:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerName">
        customer_name = #customerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="quotationDate">
        quotation_date = #quotationDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="sellerName">
        seller_name = #sellerName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="currency">
        currency_ = #currency:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="currencyName">
        currency_name = #currencyName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="paymentCondition">
        payment_condition = #paymentCondition:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="taxRate">
        tax_rate = #taxRate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="quotationType">
        quotation_type = #quotationType:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="cusContactPerson">
        cus_contact_person = #cusContactPerson:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="status">
        status = #status:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="deliveryType">
        delivery_type = #deliveryType:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="taxMoney">
        tax_money = #taxMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="productMoney">
        product_money = #productMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="totalMoney">
        total_money = #totalMoney:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="editTime">
        edit_time = #editTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="editorId">
        editor_id = #editorId:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editorName">
        editor_name = #editorName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="editDate">
        edit_date = #editDate:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="userName">
        user_name = #userName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="memo">
        memo = #memo:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="overallRebate">
        overall_rebate = #overallRebate:DECIMAL#
      </isNotNull>
      <isNotNull prepend="," property="finalMoney">
        final_money = #finalMoney:DECIMAL#
      </isNotNull>
        <isNotNull prepend="," property="customerFax">
        customer_fax = #customerFax:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="customerPhone">
        customer_phone = #customerPhone:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="urgentLevel">
        urgent_level = #urgentLevel:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="validStartDate">
        valid_start_date = #validStartDate:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="validEndDate">
        valid_end_date = #validEndDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="willOrderExpected">
        will_order_expected = #willOrderExpected:INTEGER#
      </isNotNull>
      <isNotNull prepend="," property="willFormalDate">
        will_formal_date = #willFormalDate:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="impToQuoCode">
        imp_to_quo_code = #impToQuoCode:VARCHAR#
      </isNotNull>
      
      <isNotNull prepend="," property="sellerId">
        seller_id = #sellerId:VARCHAR#
      </isNotNull>
    </dynamic>
    where id = #id:VARCHAR#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Tue Nov 10 13:49:09 CST 2009.
    -->
    update t_quotation_infor
    set contract_infor_id = #contractInforId:VARCHAR#,
      quotation_code = #quotationCode:VARCHAR#,
      customer_code = #customerCode:VARCHAR#,
      customer_name = #customerName:VARCHAR#,
      quotation_date = #quotationDate:VARCHAR#,
      seller_name = #sellerName:VARCHAR#,
      currency_ = #currency:VARCHAR#,
      currency_name = #currencyName:VARCHAR#,
      payment_condition = #paymentCondition:VARCHAR#,
      tax_rate = #taxRate:DECIMAL#,
      quotation_type = #quotationType:INTEGER#,
      cus_contact_person = #cusContactPerson:VARCHAR#,
      status = #status:INTEGER#,
      delivery_type = #deliveryType:VARCHAR#,
      tax_money = #taxMoney:DECIMAL#,
      product_money = #productMoney:DECIMAL#,
      total_money = #totalMoney:DECIMAL#,
      edit_time = #editTime:TIMESTAMP#,
      editor_id = #editorId:VARCHAR#,
      editor_name = #editorName:VARCHAR#,
      edit_date = #editDate:TIMESTAMP#,
      user_name = #userName:VARCHAR#,
      memo = #memo:VARCHAR#,
      overall_rebate = #overallRebate:DECIMAL#,
      final_money = #finalMoney:DECIMAL#,
      customer_fax = #customerFax:VARCHAR#,
      customer_phone = #customerPhone:VARCHAR#,
      urgent_level = #urgentLevel:INTEGER#,
      valid_start_date = #validStartDate:VARCHAR#,
      valid_end_date = #validEndDate:VARCHAR#,
      
      will_order_expected = #willOrderExpected:INTEGER#,
      will_formal_date = #willFormalDate:VARCHAR#,
      
      imp_to_quo_code = #impToQuoCode:VARCHAR#,
      
      seller_id = #sellerId:VARCHAR#
    where id = #id:VARCHAR#
  </update>
  <update id="updateStatus" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">

  update t_quotation_infor
    set status =#status:INTEGER# 
    where id = #id:VARCHAR#
  </update>
  
  <update id="updateImpQuoCode" parameterClass="com.tl.resource.dao.pojo.TQuotationInfor">
    
    update t_quotation_infor
    set imp_to_quo_code =#impToQuoCode:VARCHAR# 
    where id = #id:VARCHAR#
  </update>
  
  <select id="getQuotationListForOrder" parameterClass="java.util.Map" resultClass="java.util.List" resultMap="mapForOrderSeleQuo">
	SELECT ccc.*,ct.cus_lock_status,(SELECT COUNT(*) FROM t_accessories ac WHERE ac.business_id = ccc.id) file_count  FROM (
		SELECT abc.*,aa.order_amount FROM (
		SELECT dd.*,cc.out_amount
		FROM (							 
			SELECT tci.id,tci.quotation_code, IFNULL(SUM(nn.amount),0) con_amount,cus.lock_status cus_lock_status 
			FROM t_quotation_infor tci,t_resource_purview trp,t_customers_infor cus,t_quotation_product_detail nn
					    WHERE trp.user_id = #currUserId#
						 AND quotation_type = #quotationType#
						 AND tci.status = 6
						 AND trp.resource_type = 1 
						 AND tci.editor_id = trp.target_user_id
						 AND nn.parent_tools_id = 'root' 
						 AND nn.leaf = #leaf#
						 AND nn.quotation_infor_id = tci.id
						 and tci.customer_code = cus.customer_code   
						 <isNotEmpty property="quotationCode" prepend="and">
					      <![CDATA[ tci.quotation_code like '%$quotationCode$%' ]]>
					    </isNotEmpty>
					    <isNotEmpty property="customerName" prepend="and">
					      <![CDATA[ tci.customer_name like '%$customerName$%' ]]>
					    </isNotEmpty>
					     <isNotEmpty property="startTime" prepend="and">
					      <![CDATA[ DATE_FORMAT(tci.edit_date,'%Y-%m-%d') >= '$startTime$' ]]>
					    </isNotEmpty>
					     <isNotEmpty property="endTime" prepend="and">
					      <![CDATA[ DATE_FORMAT(tci.edit_date,'%Y-%m-%d') <= '$endTime$' ]]>
					    </isNotEmpty>
					GROUP BY tci.id,cus.lock_status
					order by id desc
		) dd LEFT JOIN 
		(
			SELECT IFNULL(SUM(amount),0) out_amount,osi.quotation_id FROM t_out_stock_infor osi,t_out_stock_detail osd 
			WHERE osi.id = osd.out_stock_infor_id 
			AND osi.out_stock_type = #outStockType#  AND osd.parent_tools_id = 'root' AND osd.leaf = #leaf#
			GROUP BY osi.quotation_id
		) cc 
		ON dd.id = cc.quotation_id
		) abc 
		LEFT JOIN
		(
			SELECT IFNULL(SUM(order_amount),0) order_amount,oi.quotation_code FROM t_order_infor oi,t_order_detail od 
			WHERE oi.id = od.stock_order_infor_id
					  AND od.parent_tools_id = 'root' AND od.leaf = #leaf#
					  GROUP BY oi.quotation_code
		) aa
		ON abc.quotation_code = aa.quotation_code
		 WHERE abc.con_amount > IFNULL(aa.order_amount,0) + IFNULL(abc.out_amount,0)
	) ct,t_quotation_infor ccc
	WHERE ct.id = ccc.id
	limit $startIndex$,$pageSize$
  </select>
  
  <select id="getQuotationListCountForOrder" parameterClass="java.util.Map" resultClass="java.lang.Integer">
   SELECT count(*)  FROM (
		SELECT abc.*,aa.order_amount FROM (
		SELECT dd.*,cc.out_amount
		FROM (							 
			SELECT tci.id,tci.quotation_code, IFNULL(SUM(nn.amount),0) con_amount,cus.lock_status cus_lock_status 
			FROM t_quotation_infor tci,t_resource_purview trp,t_customers_infor cus,t_quotation_product_detail nn
					    WHERE trp.user_id = #currUserId#
						 AND quotation_type = #quotationType#
						 AND tci.status = 6
						 AND trp.resource_type = 1 
						 AND tci.editor_id = trp.target_user_id
						 AND nn.parent_tools_id = 'root' 
						 AND nn.leaf = #leaf#
						 AND nn.quotation_infor_id = tci.id
						  and tci.customer_code = cus.customer_code  
						 <isNotEmpty property="quotationCode" prepend="and">
					      <![CDATA[ tci.quotation_code like '%$quotationCode$%' ]]>
					    </isNotEmpty>
					    <isNotEmpty property="customerName" prepend="and">
					      <![CDATA[ tci.customer_name like '%$customerName$%' ]]>
					    </isNotEmpty>
					     <isNotEmpty property="startTime" prepend="and">
					      <![CDATA[ DATE_FORMAT(tci.edit_date,'%Y-%m-%d') >= '$startTime$' ]]>
					    </isNotEmpty>
					     <isNotEmpty property="endTime" prepend="and">
					      <![CDATA[ DATE_FORMAT(tci.edit_date,'%Y-%m-%d') <= '$endTime$' ]]>
					    </isNotEmpty>
					GROUP BY tci.id,cus.lock_status  ORDER BY id DESC
		) dd LEFT JOIN 
		(
			SELECT IFNULL(SUM(amount),0) out_amount,osi.quotation_id FROM t_out_stock_infor osi,t_out_stock_detail osd 
			WHERE osi.id = osd.out_stock_infor_id 
			AND osi.out_stock_type = #outStockType#  AND osd.parent_tools_id = 'root' AND osd.leaf = #leaf#
			GROUP BY osi.quotation_id
		) cc 
		ON dd.id = cc.quotation_id
		) abc 
		LEFT JOIN
		(
			SELECT IFNULL(SUM(order_amount),0) order_amount,oi.quotation_code FROM t_order_infor oi,t_order_detail od 
			WHERE oi.id = od.stock_order_infor_id
					  AND od.parent_tools_id = 'root' AND od.leaf = #leaf#
					  GROUP BY oi.quotation_code
		) aa
		ON abc.quotation_code = aa.quotation_code
		 WHERE abc.con_amount > IFNULL(aa.order_amount,0) + IFNULL(abc.out_amount,0)
	) ct,t_quotation_infor ccc
	WHERE ct.id = ccc.id
  </select>
  
	<select id="getExpectedQuo2QuoCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
	   
	   SELECT COUNT(*) FROM t_quotation_infor quo,t_customers_infor cus 
		WHERE quo.customer_code = cus.customer_code
		AND quo.quotation_type = 3 AND quo.status not in(4,5,7) 
		<![CDATA[AND quo.will_formal_date <= DATE_FORMAT(SYSDATE(),'%Y-%m-%d')]]>
		AND (quo.editor_id = #currUserId# or cus.own_contact_person_id = #currUserId#)
		
	</select>
	<select id="getTryTools2DeliveryCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
	   <![CDATA[
			SELECT COUNT(*) FROM (
				SELECT quo.id,sum(qpd.amount) quo_amount
				FROM t_quotation_infor quo,t_quotation_product_detail qpd
				WHERE quo.id = qpd.quotation_infor_id 
				AND quo.quotation_type = 4 AND quo.status = 6
				AND quo.valid_start_date <= DATE_FORMAT(SYSDATE(),'%Y-%m-%d')
				GROUP BY quo.id
			) q LEFT JOIN (
				SELECT di.quotation_id,sum(dd.amount) delivery_amount
				FROM t_delivery_infor di,t_delivery_detail dd
				WHERE di.id = dd.delivery_infor_id
				AND di.delivery_type = 2 
				AND di.status = 2
				GROUP BY di.quotation_id
			) t
			ON q.id = t.quotation_id
			WHERE q.quo_amount > IFNULL(t.delivery_amount,0)
		]]>
	</select>
	<select id="getTryTools2UploadReportCount" parameterClass="java.util.Map" resultClass="java.lang.Integer">
	   SELECT COUNT(DISTINCT a.id) FROM (
		SELECT quo.id 
		FROM 
		(
		SELECT quo2.* FROM t_quotation_infor quo2,t_customers_infor cus 
		WHERE quo2.customer_code = cus.customer_code 
		AND (quo2.editor_id = #currUserId# or cus.own_contact_person_id = #currUserId#)
		) quo 
		WHERE quo.quotation_type = 4 
		AND quo.status NOT IN (0,3)
 		<![CDATA[AND quo.valid_end_date <= DATE_FORMAT(SYSDATE(),'%Y-%m-%d')]]>
		) a LEFT JOIN (SELECT tc.business_id FROM t_accessories tc WHERE tc.business_type = 11) ac
		ON a.id = ac.business_id
		WHERE ac.business_id IS NULL
	</select>
	<select id="quoAllDeliveryed" parameterClass="java.lang.String" resultClass="java.math.BigDecimal">
	SELECT ((SELECT IFNULL(SUM(amount),0) FROM t_quotation_product_detail WHERE quotation_infor_id = #value# AND parent_tools_id = 'root')
	-
	(SELECT IFNULL(SUM(dd.amount),0) FROM t_delivery_infor d,t_delivery_detail dd WHERE d.id = dd.delivery_infor_id AND d.quotation_id = #value#))
	aa
	FROM DUAL
	</select>
</sqlMap>